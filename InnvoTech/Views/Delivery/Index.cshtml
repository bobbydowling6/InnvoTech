@using Microsoft.AspNetCore.Mvc.ModelBinding;
@using InnvoTech.Models;
@model InnvoTech.Models.DeliveryViewModel
@{
    ViewData["Title"] = "Index";
    var states = (new string[] { "", "Alabama", "Alaska", "Arkansas", "Arkansas", "California", "Colorado", "Connecticut", "Delaware",
"Florida", "Georgia", "Hawaii", "Idaho", "Illinois", "Indiana", "Iowa", "Kansas", "Kentucky", "Louisiana", "Maine", "Maryland",
"Massachusetts", "Michigan", "Minnesota", "Mississippi", "Missouri", "Montana", "Nebraska", "Nevada", "New Hampshire", "New Jersey",
"New Mexico", "New York", "North Carolina", "North Dakota", "Ohio", "Oklahoma", "Oregon", "Pennsylvania", "Rhode Island",
"South Carolina", "South Dakota", "Tennessee", "Texas", "Utah", "Vermont", "Virginia", "Washington", "West Virginia", "Wisconsin", "Wyoming" }).Select(x => new SelectListItem { Text = x, Value = x });
}
@if (Model.CartProducts != null)
{
    <div class="row">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Product</th>
                    <th>Quantity</th>
                    <th>Price</th>
                </tr>
            </thead>
            @foreach (var item in Model.CartProducts)
            {
                <tr>
                    <td>@item.Products.Name</td>
                    <td>
                        <form asp-action="update" asp-controller="delivery" method="post" class="form-inline">
                            <input name="productId" value="@item.Products.Id" type="hidden" />                            
                            <input name="quantity" value="@item.Quantity" type="number" class="form-control-sm" /><input type="submit" value="Update Quantity" class="btn btn-info" />
                            </form>
                    </td>
                    <td>@((item.Products.Price ?? 0m).ToString("c"))</td>
                </tr>
            }
            <tfoot>
                <tr>
                    <th colspan="2">Subtotal</th>
                    <th>@Model.CartProducts.Sum(x => (x.Products.Price ?? 0m) * x.Quantity).ToString("c")</th>
                </tr>
            </tfoot>
        </table>
    </div>
}

@if (!this.ViewContext.ModelState.IsValid)
{
    <div asp-validation-summary="All" class="alert alert-danger"></div>
}
    <form method="post" asp-action="Index" asp-controller="Delivery">
        <div class="form-group">
            <label asp-for="Address"></label>
            <input asp-for="Address" class="@(ViewData.ModelState.ContainsKey("Address") && ViewData.ModelState.First(x => x.Key == "Address").Value.ValidationState == ModelValidationState.Invalid ? "form-control is-invalid" : "form-control")" placeholder="address" />
            <span asp-validation-for="Address" class="invalid-feedback"></span>
        </div>
        <div class="form-group">
            <label for="inputAddress2">Secondary Address</label>
            <input type="text" class="form-control" id="inputAddress2" placeholder="Apartment, studio, or floor">
        </div>
        <div class="form-row">
            <div class="form-group col-md-6">
                <label asp-for="City"></label>
                <input asp-for="City" placeholder="city" class="@(ViewData.ModelState.ContainsKey("City") && ViewData.ModelState.First(x => x.Key == "City").Value.ValidationState == ModelValidationState.Invalid ? "form-control is-invalid" : "form-control")" />
                <span asp-validation-for="City" class="invalid-feedback"></span>
            </div>
            <div class="form-group col-md-4">
                <label asp-for="State"></label>
                <select asp-for="State" asp-items="states" class="@(ViewData.ModelState.ContainsKey("State") && ViewData.ModelState.First(x => x.Key == "State").Value.ValidationState == ModelValidationState.Invalid ? "form-control is-invalid" : "form-control")"></select>
                <span asp-validation-for="State" class="invalid-feedback"></span>

            </div>
            <div class="form-group col-md-2">
                <label asp-for="Zip"></label>
                <input asp-for="Zip" placeholder="zip code" class="@(ViewData.ModelState.ContainsKey("Zip") && ViewData.ModelState.First(x => x.Key == "Zip").Value.ValidationState == ModelValidationState.Invalid ? "form-control is-invalid" : "form-control")" />
                <span asp-validation-for="Zip" class="invalid-feedback"></span>

            </div>
        </div>
        <div class="form-group">
            <label asp-for="Date"></label>
            <input asp-for="Date" class="@(ViewData.ModelState.ContainsKey(" Date") && ViewData.ModelState.First(x=> x.Key == "Date").Value.ValidationState == ModelValidationState.Invalid ? "form-control is-invalid" : "form-control")" placeholder="Date" />
            <span asp-validation-for="Date" class="invalid-feedback"></span>
        </div>

        <div class="form-group">
            <label for="creditcardnumber">Credit Card</label>
            <input type="text" name="creditcardnumber" class="form-control" required/>
        </div>
        <div class="form-group">
            <label for="creditcardname">Name on Card</label>
            <input type="text" name="creditcardname" class="form-control" required/>
        </div>
        <div class="form-group">
            <label for="creditcardverificationvalue">CVV</label>
            <input type="text" name="creditcardverificationvalue" class="form-control" required />
        </div>
        <div class="form-group">
            <label for="expirationmonth">Expiration Month</label>
            <div class="form-row">


                <div class="col">
                    <select name="expirationmonth" class="form-control" required>
                        <option value="01">01</option>
                        <option value="02">02</option>
                        <option value="03">03</option>
                        <option value="04">04</option>
                        <option value="05">05</option>
                        <option value="06">06</option>
                        <option value="07">07</option>
                        <option value="08">08</option>
                        <option value="09">09</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                    </select>
                </div>
                <div class="col">
                    <select name="expirationyear" class="form-control" required>
                        <option value="2018">2018</option>
                        <option value="2019">2019</option>
                        <option value="2020">2020</option>
                        <option value="2021">2021</option>
                    </select>
                    </div>
                </div>
            </div>
        <button type="submit" class="btn btn-success">Submit</button>
    </form>

